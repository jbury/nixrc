#!/usr/bin/env bash

function window_props() {
    value=$1
    window_id=$2

    IFS=" " read -r -a xprops <<< "$(swaywindow -p "$window_id" 2>/dev/null | jq -r '@text "\"\(.class)\" \"\(.title)\""')"

    class=$(echo "${xprops[0]}" | tr -d \")
    title=$(echo "${xprops[1]}" | tr -d \")

    if [ "$class" == "" ] || [ "$title" == "" ]
    then
        class=$(swaywindow -n "$window_id" 2>/dev/null)
        title=$(swaywindow -t "$window_id" 2>/dev/null)
    fi

    case $value in
        "WM_CLASS")
            echo "WM_CLASS = \"$class\", \"$class\""
            ;;
        "_NET_WM_NAME")
            echo "_NET_WM_NAME = \"$title\""
            ;;
        *)
            echo "Not implemented"
            exit 1
    esac
}

case $1 in
    "-id")
        window_props "$3" "$2"
        ;;
    *)
        echo "Not implemented"
        exit 1
esac
